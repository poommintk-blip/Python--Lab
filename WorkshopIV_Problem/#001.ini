import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
from sklearn import datasets
from sklearn.cluster import KMeans
from sklearn.metrics import confusion_matrix, accuracy_score

#สามารถนำเข้าข้อมูล wine data จาก sklearn datasets ได้ถูกต้อง
wine_data = datasets.load_wine()
wine = datasets.load_wine()

#สามารถแปลงข้อมูล wine data ให้เป็นตารางใน DataFrame พร้อมแสดงผลออกทางจอภาพ
df = pd.DataFrame(wine.data)
print(df)

#สามารถสร้างแบบจำลองโดยใช้เทคนิค K-means clustering โดยกำหนดให้ k = 3
KMeans = KMeans(n_clusters=3, random_state=42)
KMeans.fit(wine.data)
y_pred = KMeans.predict(wine.data)
y_true = wine.target

#สามารถแสดงข้อมูลผลลัพธ์ (wine target/y_true) และข้อมูลที่ได้จากการทำนาย (y_pred) ออกทางจอภาพได้
print("Target or Actual Values")
print(y_pred)
print("Predicted Values")
print(y_true)

#สามารถสร้างแผนภาพกราฟแบบจุด 2 กราฟ ซึ่งแสดงสีของข้อมูลที่แตกต่างกัน โดยใช้สีตาม y_true และ y_pred
#ส่วนข้อมูล wine data ที่นำมาแสดง แกนนอนคือข้อมูลในคอลัมน์แรก และแกนตั้งคือข้อมูลในคอลัมน์ที่สอง
colors = np.array(['yellow', 'red', 'blue']) # 0=yellow, 1=red, 2=blue
plt.scatter(x=wine.data[:,0], y=wine.data[:,1], c=colors[y_true])
plt.title('y_true')
plt.show()

plt.scatter(x=wine.data[:,0], y=wine.data[:,1], c=colors[y_pred])
plt.title('y_pred')
plt.show()

#สามารถแสดง Confusion Matrix ของ y_true และ y_pred ออกทางจอภาพได้
cm1 = confusion_matrix(y_true, y_pred)
print(" ")
print("Confusion Matrix: ")
print(cm1)

#สามารถประเมินแบบจำลองโดยใช้ Accuracy ได้ โดยแสดงค่าทั้งหมดออกทางจอภาพ
accuracy1 = accuracy_score(y_true, y_pred)
print("\nAccuracy Score: ")
print(accuracy1)