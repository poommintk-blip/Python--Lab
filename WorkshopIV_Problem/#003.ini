import numpy as np
import pandas as pd
from mlxtend.frequent_patterns import apriori, association_rules
from mlxtend.preprocessing import TransactionEncoder
#import warnings 
#warnings.filterwarnings("ignore") -- ลบบัค Error หมดอายุ

#สามารถนำเข้าข้อมูลจาก weather1.csv ได้ และแสดงในรูปแบบตารางได้
from google.colab import drive
drive.mount('/content/drive')
data = pd.read_csv('/content/drive/MyDrive/Python/weather1 (1).csv')

#สามารถแปลงข้อมูลให้อยู่ในรูปแบบ dataset ได้
datasets = []
for i in range(0, len(data)):
    datasets.append([str(data.values[i, j]) for j in range(0, 4)])
print(data)
print(" ")
print(datasets)
print(" ")

#สามารถแปลง dataset ให้อยู่ในรูปแบบ Numpy boolean array
encodeObj = TransactionEncoder()
productArray = encodeObj.fit(datasets).transform(datasets) #tranform dataset to Numpy boolean array
print(productArray)
print(" ")

#สามารถแปลง Numpy boolean array ให้อยู่ใน DataFrame ดังรูปในโจทย์
df = pd.DataFrame(productArray, columns=encodeObj.columns_)
print(df)

#สามารถแสดงผล frequent_patterns ได้ โดยใช้ฟังก์ชั่น apriori และกำหนด min_support=0.2
frequent_itemsets = apriori(df, min_support=0.2, use_colnames=True)
print(" ")
print(frequent_itemsets)

#สามารถสร้าง และแสดงผล Associate Rules โดยกำหนดตัววัดเป็น 'lift' และกำหนด min_threshold=1.6 ได้
association_rules(frequent_itemsets, metric="lift", min_threshold=1.6)
